HƯỚNG DẪN CỐ ĐỊNH & SCROLL BẢNG CHẤM CÔNG (KHASERVICE HR)
======================================================

MỤC TIÊU
-------
CỐ ĐỊNH (STICKY):
- Cột Nhân viên (bên trái)
- Header 3 tầng:
  + Ngày trong tháng
  + Ngày (1–31)
  + Thứ (T2–CN)
- Cột Ngày nghỉ (P/CĐ, VR/Ô/Ts, Lễ/Tết)
- Cột Công làm thêm (Giờ TC, CN, Lễ/Tết)
- Cột Tổng Công

SCROLL:
- Scroll ngang: các ngày trong tháng
- Scroll dọc: danh sách nhân viên

XỬ LÝ:
- Nhập dữ liệu theo ngày → cập nhật realtime các cột cố định bên phải


I. CẤU TRÚC HTML CHUẨN
---------------------
<div class="table-container">
  <table class="attendance-table table table-bordered">
    <thead>
      <!-- Header 3 tầng -->
    </thead>
    <tbody>
      <!-- Nhân viên -->
    </tbody>
  </table>
</div>


II. CSS CỐT LÕI (DÁN VÀO admin_style.css)
-----------------------------------------

/* CONTAINER SCROLL */
.table-container {
  height: calc(100vh - 250px);
  overflow: auto;            /* Scroll X + Y */
  position: relative;
  width: 100%;
}

/* TABLE */
.attendance-table {
  table-layout: fixed;
  width: 100%;               /* KHÔNG dùng width: max-content */
  border-collapse: separate;
  border-spacing: 0;
}

/* CELL CHUNG */
.attendance-table th,
.attendance-table td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
}

/* STICKY HEADER 3 TẦNG */
thead th {
  position: sticky;
  top: 0;
  z-index: 100;
  background: #f8fafc;
}
thead tr:nth-child(2) th { top: 30px; }
thead tr:nth-child(3) th { top: 55px; }

/* STICKY CỘT NHÂN VIÊN (TRÁI) */
.attendance-table th:first-child,
.attendance-table td:first-child {
  position: sticky;
  left: 0;
  z-index: 120;
  background: #f8fafc;
  border-right: 2px solid #cbd5e1;
}

/* STICKY CỘT PHẢI (SUMMARY) */
.sticky-right {
  position: sticky;
  z-index: 110;
  background: #f8fafc;
}

/* VỊ TRÍ CỐ ĐỊNH BÊN PHẢI */
.sticky-leave-1 { right: 250px; } /* P/CĐ */
.sticky-leave-2 { right: 210px; } /* VR/Ô/Ts */
.sticky-leave-3 { right: 170px; } /* Lễ/Tết */

.sticky-ot-1 { right: 130px; }    /* Giờ TC */
.sticky-ot-2 { right: 90px; }     /* CN */
.sticky-ot-3 { right: 50px; }     /* Lễ/Tết */

.sticky-total { right: 0; }       /* Tổng Công */

/* RESPONSIVE MÀN NHỎ */
@media (max-width: 1440px) {
  table col[style*="45px"] {
    width: 38px !important;
  }
  .attendance-table {
    font-size: 0.8rem;
  }
}


III. HTML GÁN CLASS STICKY PHẢI (VÍ DỤ)
--------------------------------------
<td class="sticky-right sticky-leave-1 sum-p-cd"></td>
<td class="sticky-right sticky-leave-2 sum-other"></td>
<td class="sticky-right sticky-leave-3 sum-holiday"></td>

<td class="sticky-right sticky-ot-1 sum-ot-normal"></td>
<td class="sticky-right sticky-ot-2 sum-ot-sun"></td>
<td class="sticky-right sticky-ot-3 sum-ot-hol"></td>

<td class="sticky-right sticky-total sum-total"></td>


IV. XỬ LÝ JS (TÍNH REALTIME – GIỮ NGUYÊN)
---------------------------------------
$(document).on('change', '.att-input', function() {
  let tr = $(this).closest('tr');
  calculateRow(tr); // cập nhật các cột sticky bên phải
});

Hàm calculateRow():
- Duyệt toàn bộ ngày trong hàng
- Tính:
  + Nghỉ
  + OT
  + CN
  + Tổng công
- Ghi kết quả vào các ô .sum-* (sticky)

KẾT LUẬN
--------
- KHÔNG ép bảng vừa màn → dùng scroll ngang
- Sticky trái + header + sticky phải = UX chuẩn HR
- Công thức chạy realtime, không phụ thuộc scroll

File này dùng để lưu lại làm chuẩn triển khai & bảo trì.

Gần đúng như theo yêu cầu rồi.
Cuộn ngang các ngày trong tháng không đè lên cột nhân viên và các 7 cột cuối cùng

ĐẶC TẢ THIẾT KẾ BẢNG CHẤM CÔNG
1. Tổng quan bố cục

Thiết kế bảng chấm công dạng table, chia theo trục ngang thành các khối:

Khối cố định bên trái: thông tin nhân viên

Khối trung tâm: các ngày trong tháng (01 đến 31)

Khối cố định bên phải: tổng hợp ngày nghỉ, công làm thêm và ngày làm việc theo quy định

Bảng cho phép:

Scroll dọc để xem danh sách nhân viên

Scroll ngang để xem các ngày trong tháng

Các cột cố định không bị trôi khi scroll

Không sử dụng zoom trình duyệt để xem đủ nội dung.

2. Cấu trúc cột cố định bên trái

Gồm 3 cột, chiếm rowspan toàn bộ header (3 tầng):

STT (rộng khoảng 50px)

Họ và tên (rộng khoảng 180–220px)

Chức vụ (rộng khoảng 120px)

Các cột này:

Luôn cố định bên trái khi scroll ngang

Nền giống header

Viền phải rõ để phân tách với phần ngày

3. Header 3 tầng
Tầng 1 – Nhóm cột

“Ngày trong tháng” (colspan = 31)

“Ngày nghỉ” (colspan = 3)

“Công làm thêm” (colspan = 3)

“Ngày làm việc theo quy định” (1 cột)

Các cột STT, Họ và tên, Chức vụ dùng rowspan = 3.

Tầng 2 – Ngày trong tháng

Hiển thị từ 01 đến 31

Mỗi ngày là 1 cột riêng

Canh giữa

Font đậm vừa

Tầng 3 – Thứ trong tuần

T2, T3, T4, T5, T6, T7, CN

Nằm ngay dưới ngày tương ứng

Font nhỏ hơn tầng ngày

Canh giữa

4. Định dạng Chủ nhật (CN)

Các cột có thứ là Chủ nhật:

Nền xanh nhạt

Áp dụng đồng bộ cho:

Header ngày

Header thứ

Ô dữ liệu bên dưới

Màu gợi ý: xanh nhạt, dễ phân biệt nhưng không quá đậm.

5. Khối “Ngày nghỉ” (cố định bên phải)

Gồm 3 cột:

P/CĐ

VR/Ô/Ts

Lễ, Tết

Các cột này:

Luôn cố định bên phải khi scroll ngang

Tự động tổng hợp từ dữ liệu nhập trong các ngày

6. Khối “Công làm thêm” (cố định bên phải)

Gồm 3 cột:

Giờ tăng ca

Chủ nhật / Ngày nghỉ hằng tuần

Lễ, Tết

Các cột này:

Cố định bên phải

Tính toán tự động dựa trên dữ liệu từng ngày

7. Khối tổng hợp cuối

Cột “Ngày làm việc theo quy định”

Có thể mở rộng thêm “Tổng công” nếu cần

Cột này:

Cố định bên phải

Chỉ hiển thị kết quả, không nhập liệu

8. Kích thước cột ngày

Mỗi ngày rộng khoảng 40–45px

Không co giãn theo màn hình

Canh giữa nội dung

Khi tổng chiều rộng vượt màn hình:

Bắt buộc xuất hiện scroll ngang

9. Hành vi nhập liệu

Mỗi ô ngày cho phép nhập:

Ký hiệu công (X, P, L, TS…)

Hoặc số giờ tăng ca

Khi người dùng thay đổi dữ liệu trong ô ngày:

Tự động cập nhật:

Ngày nghỉ

Công làm thêm

Ngày làm việc theo quy định

Các cột tổng hợp là readonly.

10. Yêu cầu UX

Header luôn hiển thị khi scroll dọc

Các cột cố định không bị lệch khi scroll ngang

Không vỡ giao diện ở màn hình laptop 1366px trở lên

Phù hợp dùng cho 50–500 nhân viên

11. Mục đích sử dụng

Thiết kế phục vụ:

Phần mềm chấm công hành chính

Doanh nghiệp, chung cư, đơn vị nhiều ca

Giao diện desktop web (HR system)

===============================================================
Đây là thứ tự chính xác trong Cấu hình Phòng ban và Trên bảng chấm công                                                                 
Ban Giám Đốc	
- Tổng Giám Đốc
 - Phó Tổng Giám Đốc
Phòng Kế toán	
- Trưởng Phòng
- Kế toán
Phòng Kinh doanh	
- Trưởng Phòng
- Nhân viên
Phòng Nhân sự	
- Trưởng Phòng
- Nhân viên
Phòng IT	
- Trưởng phòng IT
- Nhân viên
Ban Quản lý	
- Trưởng Ban
- Phó Ban
- Giám sát dịch vụ
- Kế toán dự án
- Lễ tân
- Chăm sóc khách hàng
Kỹ thuật	
- Kỹ sư trưởng
- Tổ trưởng
- Nhân viên
An ninh - Bảo vệ	
- Tổ trưởng
- Nhân viên
Vệ sinh - Tạp Vụ	
- Tổ trưởng
- Nhân viên
Cây xanh	
- Nhân viên
 

Mã NV	Họ và tên	Phòng ban	Dự án hiện tại	Tài khoản	Hồ sơ	Trạng thái	Thao tác
http://localhost/khaservice-hr/admin/modules/employees/index.php
Thay đổi lại một xíu
Mã NV	Họ và tên	  Phòng ban Chức vụ  Dự án hiện tại	Hồ sơ	Trạng thái	Thao tác


✦ Dựa trên mẫu Phiếu-lương.html và những nghiệp vụ nội bộ chúng ta vừa trao đổi, tôi hiểu cấu trúc một Phiếu lương
  chuyên nghiệp (đặc biệt là cho mảng dịch vụ/dự án) gồm 3 phần cốt lõi và các quy tắc tính toán sau:

  1. Phần Thông tin định danh (Header)
   * Ngữ cảnh: Phải thể hiện rõ Tháng/Năm lương và Tên Dự án/Bộ phận (vì nhân viên có thể luân chuyển).
   * Cá nhân: Họ tên và Chức danh (quy định mức lương khoán).
   * Tham chiếu: Phải hiện Lương thực tế/tháng và Công chuẩn (thường là 26 hoặc 27 ngày) để nhân viên biết căn cứ tính
     toán.

  2. Phần I: Thu nhập thực tế (Các khoản cộng vào)
  Đây là phần nhân viên quan tâm nhất, chia làm 4 nhóm nhỏ:
   * Nhóm công cơ bản: Lương ngày công thực tế (X).
   * Nhóm công được hưởng lương: Phép (P), Chế độ (CĐ), Lễ/Tết (L, T). Dù không đi làm nhưng vẫn được trả lương theo chế
     độ công ty.
   * Nhóm làm thêm (Biến động): Tăng ca (OT x1.5) và Làm ngày Lễ (F x300%). Phần này phải tách riêng vì đơn giá rất cao.
   * Nhóm Phụ cấp & Thưởng: Các khoản cố định (Ăn ca, điện thoại) và các khoản bồi dưỡng, thưởng dự án phát sinh trong
     tháng.

  3. Phần II: Các khoản giảm trừ (Các khoản trừ đi)
  Đây là phần nhạy cảm, cần sự minh bạch tuyệt đối:
   * Bảo hiểm (Điểm mấu chốt): Trừ 10.5% (8% BHXH, 1.5% BHYT, 1% BHTN).
       * Đặc thù: Số tiền này không trừ trên lương thực tế, mà trừ trên Lương khai báo thuế.
   * Các khoản khác:
       * Tạm ứng: Tiền nhân viên đã lấy trước trong tháng.
       * Đoàn phí: Thường là 1% lương hoặc một mức cố định.
       * Thuế TNCN: Khấu trừ theo lũy tiến sau khi trừ gia cảnh (nếu có).

  4. Phần III: Thực lĩnh (Net Income)
   * Công thức: Tổng thu nhập (I) - Tổng các khoản giảm trừ (II).
   * Đây là con số cuối cùng đổ vào tài khoản nhân viên.

  ---

  Tại sao cấu trúc này trong phần mềm của bạn lại mạnh mẽ?
  Vì tôi đã thiết kế để Bảng chấm công "nói chuyện" với Phiếu lương:
   * Nếu bạn sửa X thành P trong bảng công, phiếu lương tự động nhảy dòng số 1 sang dòng số 4.
   * Nếu bạn nhập lương đóng BH là 5 triệu nhưng lương thực là 10 triệu, hệ thống sẽ tự biết chỉ lấy 5 triệu nhân với
     10.5% để ra tiền bảo hiểm.


Cấu hình Lương của 1 nhân viên sẽ có Lương khoán/tháng, Lương hợp đồng, Phụ cấp, Thuế TNCN (%), Thưởng

Mã NV	Họ và tên	Phòng ban	Dự án hiện tại	Tài khoản	Hồ sơ	Trạng thái	Thao tác
http://localhost/khaservice-hr/admin/modules/employees/index.php
Thay đổi lại một xíu
Mã NV	Họ và tên	  Phòng ban Chức vụ Dự án hiện tại	Hồ sơ	Trạng thái	Thao tác

Hệ thống có xác định được Nhân viên đó đã đi làm thời gian nào, nghỉ lúc nào, quay lại lúc nào không
Chấm công có thể hiện được không
Lịch sử chấm công có xem được trong quá khứ lúc Nhân viên đó làm, và giờ nhân viên đó nghỉ, và sau này nhân viên đó làm lại chứ
Có lưu lại lịch sử BCC, sau này Kiểm toán kiểm tra không

Bắt đầu nghiên cứu phương án cho chức năng in Bảng chấm công, Dựa theo mẫu trên tệp Excel, In A4 nằm ngang với các tiêu đề công ty, Bảng chấm công tháng mấy, Bảng dữ liệu, Phần chữ ký, Ghi chú bla bla...Nếu có nhiều nhân viên không đủ trang 1 A4 thì cắt sang trang 2, đảm bảo các ô, dòng, cột đều có viền kẻ cho đẹp

Tính năng tương lai cần có
- Chia các quyền sử dụng cho ADMIN, Trưởng phòng Hr, IT, Nhân viên Hr, (phương án cho Hr nhiều bộ phận khác như về Lương, về BCC, về Trang thiết bị, về Hồ sơ, về Giấy tờ Đề xuất/Trình/Đề nghị...)
- Tính lương hàng tháng cho nhân viên, dự án, phòng ban,...theo bảng chấm công, cộng thêm phụ cấp mặc định của nhân viên(thay đổi nếu hr muốn)
- Quản lý được số ngày phép còn lại của nhân viên, lịch sử sử dụng phép, nghỉ phép, nghỉ các loại khác
- Thể hiện được công Nhân viên đó được phụ cấp cho những ngày nào đi hỗ trợ dự án khác, và số tiền hỗ trợ (công ty tùy chỉnh theo hoàn cảnh)
- Có thể hoạt động tốt ở localhost (mạng nội bộ công ty) và trên hosting
- Đảm bảo sao lưu về 1 máy chủ nằm ở công ty, sao lưu, fetch data liên tục về máy chủ đó (như zalo đồng bộ tin nhắn), (hạn chế sử dụng nhiều bộ nhớ trên hosting - tốn phí, lỡ bị hacker thì lộ hết), cho phép nhân viên quản lý các dự án chỉ xem được tài liệu trong khoảng 6 tháng, và thấy được tiến độ cập nhật file thôi, còn dữ liệu sau 6 tháng được hoàn tất lưu về máy chủ công ty


  Lời khuyên của tôi:
  Hệ thống này khi hoàn thiện sẽ là một công cụ ERP thu nhỏ cực kỳ mạnh mẽ cho công ty. Để đạt được điều này, chúng ta
  sẽ đi theo lộ trình:
   1. Chốt xong v1.0 trên Laravel (Đã xong phần móng).
   2. Xây dựng Module Phân quyền & Quản lý Phép (Ưu tiên tiếp theo).
   3. Xây dựng Module Lương & Phụ cấp.
   4. Cuối cùng là triển khai Cơ chế đồng bộ dữ liệu về Server công ty.

  Bạn thấy lộ trình này có phù hợp với kế hoạch của công ty không?
Số 1. Tạm thời bỏ qua. Vì khi bạn chuyển sang LRV nhiều tính năng và CSS, hiệu ứng bị sót


Lấy thiết kế của các nút thuộc filter ở trong class="filter-section" trên trang http://localhost/khaservice-hr/admin/modules/employees/index.php làm tiêu chuẩn, áp dụng cho những trang khác để đẹp hơn

vì dữ liệu nhân viên, chấm công, ... bất cứ chỗ nào có lọc theo Dự án bên trên thì sẽ có dữ liệu bảng bên dưới lớn,  thế nên mỗi khi vào những trang có lọc theo Dự án, sẽ không load dữ liệu ra sẵn, phải yêu cầu chọn dự án trước
 